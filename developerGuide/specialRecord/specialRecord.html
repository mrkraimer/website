<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <title>pvDatabase Special Record</title>
  <link rel="stylesheet" type="text/css"
  href="../../css/base.css" />
  <link rel="stylesheet" type="text/css"
  href="../../css/epicsv4.css" />
  <style type="text/css">
  /*<![CDATA[*/
     .about { margin-left: 3em; margin-right: 3em; font-size: .83em}
     table { margin-left: auto; margin-right: auto }
     .diagram { text-align: center; margin: 2.5em 0 }
     span.opt { color: grey }
     span.nterm { font-style:italic }
     span.term { font-family:courier }
     span.user { font-family:courier }
     span.user:before { content:"<" }
     span.user:after { content:">" }
     .nonnorm { font-style:italic }
     p.ed { color: #AA0000 }
     span.ed { color: #AA0000 }
     p.ed.priv { display: inline; }
     span.ed.priv { display: inline; }
  /*]]>*/</style>
  <!-- Script that generates the Table of Contents -->
  <script type="text/javascript"
  src="../../css/tocgen.js">
  </script>
</head>
<body>

<div class="head">
<h1>pvDatabase Special Record</h1>

<h2 class="nocount"></h2>
<dl>
  <dt>Original: 2019.09.11</dt>
   <dd>
   traceRecord, addRecord, removeRecord, and processRecord were implement.
   </dd>
  <dt>Revised: 2021.03.26</dt>
  <dd>
  traceRecord, addRecord, removeRecord, and processRecord were replaced by
  <br/>
  pvdbcrTraceRecord, pvdbcrAddRecord, pvdbcrRemoveRecord, and pvdbcrProcessRecord.
  <br/>
  <br/>
  pvdbcrScalar, and pvdbcrScalar are new.
  </dd>
</dl>

<dl>
  <dt>Editors:</dt>
    <dd>Marty Kraimer</dd>
</dl>

<p>This product is available via an <a
href="../../LICENSE">open source license
</a></p>

</div>


<div id="toc">
<h2 class="nocount" style="page-break-before: always">Table of Contents</h2>
</div>
<div id="contents" class="contents">

<h2>Overview</h2>
<p>PVDatabase implements a number of PVRecords that access other records in the
same pvDatabase instance.
Record instances can be created via iocshell commands.
</p>
<p>In the source file where You build your IOC the appInclude.dbd file must
include the following:
</p>
<pre>
include "base.dbd"
include "PVAServerRegister.dbd"
include "PVAClientRegister.dbd"
include "registerChannelProviderLocal.dbd"
include "qsrv.dbd"
include "pvdbSpecialRegister.dbd"
#...
</pre>
<p>Then in the st.cmd file you can issue help for each of the shell commands
implemented what is descibed below.
<br/>
You can also create PVRecord instances.
<br/>
For example:
</p>
<pre>
epics> help pvdbcrScalar
pvdbcrScalar recordName scalarType asLevel asGroup
epics> pvdbcrScalar PVRscalarDouble double
</pre>
This creates a record:
<pre>
pvinfo PVRscalarDouble
PVRscalarDouble
Server: 10.0.0.194:5075
Type:
    structure
        double value
        time_t timeStamp
            long secondsPastEpoch
            int nanoseconds
            int userTag
        alarm_t alarm
            int severity
            int status
            string message
</pre>
<h2>pvdbcrScalar and pvdbcrScalarArray</h2>
<p>Both create a record that has fields <b>value</b>, <b>timeStamp</b>, and <b>alarm</b>.
</p>
<p>
For pvdbcrScalar, the type for the value field is one of the following:
<br/>
<b>boolean</b>,<b>byte</b>,<b>short</b>,<b>int</b>,<b>long</b>,
<b>ubyte</b>,<b>ushort</b>,<b>uint</b>,<b>ulong</b>,
,<b>float</b>,<b>double</b>, or <b>string</b>.
</p>
<p>
For pvdbcrScalarArray the value field is an scalarArray of one of the above types.
</p>
<h2>pvdbcrTraceRecord</h2>
<p>
This is a record that sets the trace level in another record in the same pvDatabase.
</p>
<pre>
structure 
    structure argument
        string recordName 
        int level
    structure result
        string status 
</pre>
where
<dl>
   <dt>recordName</dt>
     <dd>
       The name of another record in the same pvDatabase.
     </dd>
   <dt>level</dt>
     <dd>
       The trace level to set.
     </dd>
   <dt>status</dt>
      <dd>
       The result of the request.
      </dd>
</dl>

<h2>pvdbcrAddRecord</h2>
<p>
This is a record that adds a record to the same pvDatabase.
This can only be used to generate "soft" records, i. e. the only process support is that
provided by PVRecord. 
This means timeStamp support.
</p>
<pre>
structure 
    structure argument
        string recordName 
        any union
    structure result
        string status 
</pre>
where
<dl>
   <dt>recordName</dt>
     <dd>
       The name of the new record to add to the same pvDatabase.
     </dd>
   <dt>union</dt>
      <dd>
      The caller must give this a PVStructure value, which will be used to generate the top
       level PVStructure for the new record.
      </dd>
   <dt>status</dt>
      <dd>
       The result of the request.
      </dd>
</dl>

<h2>pvdbcrRemoveRecord</h2>
<p>
This is a record that removes another record in the same pvDatabase.
</p>
<pre>
structure 
    structure argument
        string recordName 
    structure result
        string status 
</pre>
where
<dl>
   <dt>recordName</dt>
     <dd>
       The name of another record in the same pvDatabase.
     </dd>
   <dt>status</dt>
      <dd>
       The result of the request.
      </dd>
</dl>
<h2>pvdbcrProcessRecord</h2>
<p>
This is a record that processes other records in the same pvDatabase.
It keeps a map of all records to process.
Records can be added or removed from the list.
</p>
<pre>
structure 
    structure argument
        string command
        string recordName
    structure result
        string status
</pre>
where
<dl>
   <dt>command</dt>
     <dd>
      The command can be <b>add</b> or <b>remove</b>
     </dd>
   <dt>recordName</dt>
     <dd>
       The name of another record in the same pvDatabase.
     </dd>
   <dt>status</dt>
      <dd>
       The result of the request.
      </dd>
</dl>

</div>
</body>
</html>
